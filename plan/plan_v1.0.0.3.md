# План проєкту — версія 1.0.0.3

## Етап 2: Посилення «Нервової Системи» (Robust Backend)
Мета: Надійна, тестована, конфігуровна логіка агента.

Відповідає попереднім пунктам: Backend (3), Логіка агента (4), Конфігурація (6), Тестування (7), Безпека (8).

### 2.1 Валідація вводу
- У `models.py` додати `min_length` (напр. 3) до `MechanismInput.target_goal`.

### 2.2 Конфігурація через .env
- Додати `python-dotenv`.
- Винести коефіцієнти зростання з `agent_logic.py` у `.env` (напр. `TECH_INCREASE=20`, `EDU_INCREASE=15` тощо).
- Зчитувати значення у `agent_logic.py` з дефолтами.

### 2.3 Зворотний зв'язок API
- `POST /api/v1/apply-mechanism` повертає об’єкт:

```json
{
  "newState": SystemState,
  "explanation": "Застосовано правило 'Екологія': Технологічний +20, Освітній +15, Ризиковий +10"
}
```

- `agent_logic.run_mock_analysis()` повертає також структуру пояснення (rule id, дельти по ресурсах).
- Це живить «Історію запусків» у UI.

### 2.4 Тести
- `tests/test_api.py` (pytest + FastAPI TestClient):
  - GET `/api/v1/system-state` відповідає схемі.
  - POST `/api/v1/apply-mechanism` змінює значення очікуваних ресурсів у межах 0–100.
  - Перевірка запуску у venv (перевірити шлях `sys.executable`).

### 2.5 Оточення / Безпека
- Додати CORS (FastAPI middleware) для потенційного відокремленого фронтенду.
- Стандартизоване логування (JSON-хендлер у проді, читабельний у dev).

### Критерії успіху Етапу 2
- Працює конфігурація з .env для коефіцієнтів.
- API повертає пояснення змін.
- Є базовий набір тестів, що проходять у venv.
- CORS увімкнений і налаштований.

